{"id":"netmon-1gw","title":"Network Monitor with gopsutil","description":"Replace placeholder table with real network monitor using gopsutil. Display connections grouped by application in collapsible tree view. macOS first with abstraction for future cross-platform support. See plan: /Users/kostya/personal/claudecode/plans/quizzical-pondering-reef.md","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T21:08:22.230455+01:00","created_by":"kostya","updated_at":"2026-01-03T21:16:14.531724+01:00","closed_at":"2026-01-03T21:16:14.531724+01:00","close_reason":"All tasks completed - network monitor with gopsutil implemented"}
{"id":"netmon-1gw.1","title":"Add gopsutil v3 dependency","description":"Add github.com/shirou/gopsutil/v3 to go.mod. Run: go get github.com/shirou/gopsutil/v3","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:40.301783+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:31.289382+01:00","closed_at":"2026-01-03T21:11:31.289382+01:00","close_reason":"Closed","labels":["data-layer","phase-1"],"dependencies":[{"issue_id":"netmon-1gw.1","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:40.3037+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.10","title":"Test and polish on macOS","description":"Test with real network traffic. Verify: expand/collapse works, refresh rate adjustment, navigation, process exits handled gracefully, permission issues documented.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:09:13.662512+01:00","created_by":"kostya","updated_at":"2026-01-03T21:16:08.017374+01:00","closed_at":"2026-01-03T21:16:08.017374+01:00","close_reason":"Closed","labels":["phase-4","testing"],"dependencies":[{"issue_id":"netmon-1gw.10","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:09:13.664351+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.10","depends_on_id":"netmon-1gw.7","type":"blocks","created_at":"2026-01-03T21:09:39.602766+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.10","depends_on_id":"netmon-1gw.9","type":"blocks","created_at":"2026-01-03T21:09:39.751917+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.2","title":"Create domain models (internal/model/network.go)","description":"Create data types: Connection (Protocol, LocalAddr, RemoteAddr, State), Application (Name, PIDs, Connections, Expanded), NetworkSnapshot (Applications, Timestamp). Add SortByConnectionCount method.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:40.478278+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:55.884363+01:00","closed_at":"2026-01-03T21:11:55.884363+01:00","close_reason":"Closed","labels":["data-layer","phase-1"],"dependencies":[{"issue_id":"netmon-1gw.2","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:40.478706+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.3","title":"Create collector interface (internal/collector/collector.go)","description":"Define Collector interface with Collect(ctx) method. Add New() factory function that returns platform-specific implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:40.659547+01:00","created_by":"kostya","updated_at":"2026-01-03T21:12:22.13169+01:00","closed_at":"2026-01-03T21:12:22.13169+01:00","close_reason":"Closed","labels":["data-layer","phase-1"],"dependencies":[{"issue_id":"netmon-1gw.3","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:40.659947+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.3","depends_on_id":"netmon-1gw.2","type":"blocks","created_at":"2026-01-03T21:09:28.096704+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.4","title":"Implement macOS collector (internal/collector/darwin.go)","description":"Use gopsutil net.Connections('all') and process.NewProcess() to collect network data. Cache process names. Group connections by app name. Handle PIDs, state, protocol. Use build tag //go:build darwin","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:40.847634+01:00","created_by":"kostya","updated_at":"2026-01-03T21:13:15.726324+01:00","closed_at":"2026-01-03T21:13:15.726324+01:00","close_reason":"Closed","labels":["data-layer","phase-1"],"dependencies":[{"issue_id":"netmon-1gw.4","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:40.848106+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.4","depends_on_id":"netmon-1gw.1","type":"blocks","created_at":"2026-01-03T21:09:28.237699+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.4","depends_on_id":"netmon-1gw.3","type":"blocks","created_at":"2026-01-03T21:09:28.382553+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.5","title":"Create Bubble Tea messages (internal/ui/messages.go)","description":"Define TickMsg (time.Time) for refresh timer and DataMsg (Snapshot, Err) for data updates.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:56.439323+01:00","created_by":"kostya","updated_at":"2026-01-03T21:13:32.410301+01:00","closed_at":"2026-01-03T21:13:32.410301+01:00","close_reason":"Closed","labels":["phase-2","ui"],"dependencies":[{"issue_id":"netmon-1gw.5","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:56.441962+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.5","depends_on_id":"netmon-1gw.2","type":"blocks","created_at":"2026-01-03T21:09:28.522242+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.6","title":"Update Model struct (internal/ui/model.go)","description":"Replace table with: snapshot *NetworkSnapshot, collector Collector, cursor int, refreshInterval time.Duration. Add constants for min/max/default intervals. Update NewModel() to init collector.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:56.61428+01:00","created_by":"kostya","updated_at":"2026-01-03T21:13:59.374595+01:00","closed_at":"2026-01-03T21:13:59.374595+01:00","close_reason":"Closed","labels":["phase-2","ui"],"dependencies":[{"issue_id":"netmon-1gw.6","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:56.614774+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.6","depends_on_id":"netmon-1gw.4","type":"blocks","created_at":"2026-01-03T21:09:28.668961+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.6","depends_on_id":"netmon-1gw.5","type":"blocks","created_at":"2026-01-03T21:09:28.817296+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.7","title":"Implement Update handlers (internal/ui/update.go)","description":"Init(): start tick and fetch. Handle keys: ↑↓jk=navigate, ←→hl=collapse/expand, +=faster, -=slower, q=quit. Handle TickMsg (refresh), DataMsg (update snapshot, preserve expanded state).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:08:56.783121+01:00","created_by":"kostya","updated_at":"2026-01-03T21:14:31.157489+01:00","closed_at":"2026-01-03T21:14:31.157489+01:00","close_reason":"Closed","labels":["phase-2","ui"],"dependencies":[{"issue_id":"netmon-1gw.7","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:08:56.783573+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.7","depends_on_id":"netmon-1gw.6","type":"blocks","created_at":"2026-01-03T21:09:39.16683+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.8","title":"Add tree view styles (internal/ui/styles.go)","description":"Add styles: AppStyle, SelectedAppStyle (with background), ConnStyle, SelectedConnStyle, StatusStyle, LoadingStyle, EmptyStyle. Keep existing HeaderStyle and FooterStyle.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:09:05.710686+01:00","created_by":"kostya","updated_at":"2026-01-03T21:14:55.928009+01:00","closed_at":"2026-01-03T21:14:55.928009+01:00","close_reason":"Closed","labels":["phase-3","ui"],"dependencies":[{"issue_id":"netmon-1gw.8","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:09:05.71273+01:00","created_by":"kostya"}]}
{"id":"netmon-1gw.9","title":"Implement tree view rendering (internal/ui/view.go)","description":"Remove table rendering. Add: header with refresh rate, renderApplications() with ▼/▶ icons, renderConnection() with protocol/addr/state columns, footer with keybind hints. Handle loading/empty states.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:09:05.887882+01:00","created_by":"kostya","updated_at":"2026-01-03T21:15:41.662892+01:00","closed_at":"2026-01-03T21:15:41.662892+01:00","close_reason":"Closed","labels":["phase-3","ui"],"dependencies":[{"issue_id":"netmon-1gw.9","depends_on_id":"netmon-1gw","type":"parent-child","created_at":"2026-01-03T21:09:05.888318+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.9","depends_on_id":"netmon-1gw.6","type":"blocks","created_at":"2026-01-03T21:09:39.313417+01:00","created_by":"kostya"},{"issue_id":"netmon-1gw.9","depends_on_id":"netmon-1gw.8","type":"blocks","created_at":"2026-01-03T21:09:39.459708+01:00","created_by":"kostya"}]}
{"id":"netmon-al5","title":"Code Quality \u0026 Reliability Improvements","description":"Epic to track all code quality issues identified in the comprehensive codebase review. Focuses on data integrity, error handling, and type safety improvements.\n\n## Summary\n- 4 critical issues (data corruption, silent failures)\n- 6 important issues (unused code, type design)\n- 0% test coverage\n\n## Goals\n1. Fix data integrity issues (process cache, dropped connections)\n2. Surface errors to users instead of hiding them\n3. Clean up unused code\n4. Improve type safety\n5. Add test coverage","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T21:26:21.134923+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:11.177594+01:00","closed_at":"2026-01-03T21:59:11.177594+01:00","close_reason":"Closed"}
{"id":"netmon-al5.1","title":"Fix process cache invalidation - data corruption risk","description":"## Problem\nThe `processCache` in `internal/collector/darwin.go:17-26` grows indefinitely and never clears entries. When a process terminates and its PID is reused by a different process, the cache returns the **wrong process name**.\n\n## Impact\n- **Data Corruption**: Users see incorrect process names for connections\n- **Memory Leak**: Cache grows unbounded over long runtimes\n- **Security Risk**: Network monitoring shows wrong application for connections\n\n## Location\n```go\n// internal/collector/darwin.go:17-26\ntype darwinCollector struct {\n    processCache map[int32]string\n    cacheMu      sync.RWMutex\n}\n```\n\n## Acceptance Criteria\n- [ ] Process cache has invalidation mechanism\n- [ ] Stale entries are cleared when PIDs are reused\n- [ ] Memory usage is bounded over long runtimes\n\n## Suggested Solutions\n1. **TTL-based expiration**: Add timestamp to cache entries, expire after N seconds\n2. **Clear on cycle**: Clear entire cache at start of each collection cycle\n3. **Verify on hit**: When returning cached name, verify process still exists with that name\n\n## Notes\nPIDs are reused frequently on macOS/Linux. This is a 'when' not 'if' bug.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-03T21:27:30.397921+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.061258+01:00","closed_at":"2026-01-03T21:59:06.061258+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.1","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:30.399653+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.2","title":"Surface data collection errors to users","description":"## Problem\nAll data collection errors are silently swallowed in `internal/ui/update.go:81-85`. Users see stale data with no indication anything is wrong.\n\n## Location\n```go\n// internal/ui/update.go:81-85\ncase DataMsg:\n    if msg.Err != nil {\n        // Handle error - for now just ignore and keep old data\n        return m, nil\n    }\n```\n\n## Impact\nUsers have no visibility into:\n- Permission errors (macOS requires entitlements for network monitoring)\n- System call failures\n- Context timeouts\n- Any gopsutil library errors\n\n## Acceptance Criteria\n- [ ] Add `lastError` and `lastErrorTime` fields to Model struct\n- [ ] Display errors in the UI when they occur\n- [ ] Clear error state on successful data fetch\n- [ ] Style error display appropriately (red/warning color)\n\n## Implementation\n1. Add fields to `internal/ui/model.go`:\n```go\ntype Model struct {\n    // ... existing fields\n    lastError     error\n    lastErrorTime time.Time\n}\n```\n\n2. Update `internal/ui/update.go`:\n```go\ncase DataMsg:\n    if msg.Err != nil {\n        m.lastError = msg.Err\n        m.lastErrorTime = time.Now()\n        return m, nil\n    }\n    m.lastError = nil\n```\n\n3. Add error display in `internal/ui/view.go`\n\n4. Add `ErrorStyle` in `internal/ui/styles.go`","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-03T21:27:30.611558+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.062768+01:00","closed_at":"2026-01-03T21:59:06.062768+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.2","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:30.612006+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.3","title":"Track and display skipped connections","description":"## Problem\nWhen process name lookup fails, connections are silently dropped from results in `internal/collector/darwin.go:46-48`. Users think applications have no network connections when they actually do.\n\n## Location\n```go\n// internal/collector/darwin.go:46-48\nname := c.getProcessName(ctx, conn.Pid)\nif name == \"\" {\n    continue // Skip if we can't get process name\n}\n```\n\nAnd:\n```go\n// internal/collector/darwin.go:102-110\nproc, err := process.NewProcessWithContext(ctx, pid)\nif err != nil {\n    return \"\"\n}\nname, err := proc.NameWithContext(ctx)\nif err != nil {\n    return \"\"\n}\n```\n\n## Impact\n- Network connections silently hidden from users\n- Security monitoring compromised\n- No way to know how many connections are being dropped\n- Permission issues go undetected\n\n## Acceptance Criteria\n- [ ] Track count of skipped connections during collection\n- [ ] Return skipped count in NetworkSnapshot or separate field\n- [ ] Display skipped count in UI (e.g., \"Showing 45 connections (3 hidden)\")\n- [ ] Optionally: Show connections with \"Unknown\" process name instead of hiding\n\n## Implementation Options\n\n### Option A: Add skipped count to snapshot\n```go\ntype NetworkSnapshot struct {\n    Applications []Application\n    Timestamp    time.Time\n    SkippedCount int  // NEW\n}\n```\n\n### Option B: Show unknown processes\nInstead of skipping, group under \"Unknown\" or \"\u003cpid:1234\u003e\":\n```go\nname := c.getProcessName(ctx, conn.Pid)\nif name == \"\" {\n    name = fmt.Sprintf(\"\u003cpid:%d\u003e\", conn.Pid)\n}\n```","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-03T21:27:30.838204+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.063867+01:00","closed_at":"2026-01-03T21:59:06.063867+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.3","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:30.8386+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.4","title":"Remove unused code","description":"## Problem\nSeveral pieces of code are defined but never used, adding maintenance burden.\n\n## Unused Code to Remove\n\n### 1. internal/model/network.go:25-27\n```go\nfunc (a *Application) ConnectionCount() int {\n    return len(a.Connections)\n}\n```\nNever called - all usages use `len(app.Connections)` directly.\n\n### 2. internal/model/network.go:43-49\n```go\nfunc (s *NetworkSnapshot) TotalConnections() int {\n    total := 0\n    for _, app := range s.Applications {\n        total += len(app.Connections)\n    }\n    return total\n}\n```\nNever called anywhere.\n\n### 3. internal/ui/styles.go:47-51\n```go\nExpandedIconStyle = lipgloss.NewStyle().\n    Foreground(lipgloss.Color(\"#7D56F4\"))\n\nCollapsedIconStyle = lipgloss.NewStyle().\n    Foreground(lipgloss.Color(\"#555555\"))\n```\nDefined but icons rendered as plain strings without these styles.\n\n### 4. internal/ui/model.go:43\n```go\nsnapshot: nil,\n```\nRedundant - Go zero-initializes to nil.\n\n### 5. internal/collector/darwin.go:55-56\n```go\nPIDs:     []int32{},\nExpanded: false,\n```\nRedundant initializations.\n\n## Acceptance Criteria\n- [ ] Remove all unused code listed above\n- [ ] Verify build still passes\n- [ ] Run `go vet` and `golangci-lint` to confirm no issues","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-03T21:27:31.07816+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.064862+01:00","closed_at":"2026-01-03T21:59:06.064862+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.4","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:31.078571+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.5","title":"Extract UI state from domain model","description":"## Problem\nThe `Application` struct in `internal/model/network.go:21` contains UI state (`Expanded`) mixed with domain data. This violates separation of concerns.\n\n## Location\n```go\n// internal/model/network.go:17-22\ntype Application struct {\n    Name        string\n    PIDs        []int32\n    Connections []Connection\n    Expanded    bool  // \u003c-- UI state in domain model\n}\n```\n\n## Impact\n- Domain model coupled to UI concerns\n- Makes testing harder\n- Confusing API - why does a network Application know about being \"expanded\"?\n\n## Acceptance Criteria\n- [ ] Remove `Expanded` field from `Application` struct\n- [ ] Add `expandedApps map[string]bool` to UI Model\n- [ ] Update `mergeExpandedState` to use the new map\n- [ ] Update view rendering to check the map instead of struct field\n\n## Implementation\n\n### 1. Update internal/ui/model.go\n```go\ntype Model struct {\n    snapshot     *model.NetworkSnapshot\n    collector    collector.Collector\n    cursor       int\n    quitting     bool\n    refreshInterval time.Duration\n    width        int\n    height       int\n    expandedApps map[string]bool  // NEW: track expanded state by app name\n}\n```\n\n### 2. Update internal/model/network.go\nRemove `Expanded bool` from Application struct.\n\n### 3. Update internal/ui/view.go\n```go\nfunc (m Model) renderAppHeader(app model.Application, isSelected bool) string {\n    expanded := m.expandedApps[app.Name]  // Check map instead of struct\n    expandIcon := \"▶\"\n    if expanded {\n        expandIcon = \"▼\"\n    }\n    // ...\n}\n```\n\n### 4. Update internal/ui/update.go\nUpdate toggle logic to modify the map instead of struct field.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:27:31.326055+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.065891+01:00","closed_at":"2026-01-03T21:59:06.065891+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.5","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:31.326457+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.6","title":"Add typed constants for Protocol and State","description":"## Problem\n`Protocol` and `State` fields in `Connection` struct are raw strings, allowing any value including typos.\n\n## Location\n```go\n// internal/model/network.go:9-14\ntype Connection struct {\n    Protocol   string // TCP or UDP  \u003c-- raw string\n    LocalAddr  string\n    RemoteAddr string\n    State      string // ESTABLISHED, LISTEN, etc  \u003c-- raw string\n}\n```\n\n## Impact\n- No compile-time checking for valid values\n- Easy to introduce typos (\"tcp\" vs \"TCP\")\n- No IDE autocomplete for valid options\n- API doesn't communicate valid values\n\n## Acceptance Criteria\n- [ ] Define `type Protocol string` with constants\n- [ ] Define `type ConnectionState string` with constants\n- [ ] Update `Connection` struct to use new types\n- [ ] Update collector to use constants\n- [ ] Verify build passes\n\n## Implementation\n\n### 1. Add to internal/model/network.go\n```go\n// Protocol represents a network protocol.\ntype Protocol string\n\nconst (\n    ProtocolTCP     Protocol = \"TCP\"\n    ProtocolUDP     Protocol = \"UDP\"\n    ProtocolUnknown Protocol = \"UNK\"\n)\n\n// ConnectionState represents a TCP connection state.\ntype ConnectionState string\n\nconst (\n    StateEstablished ConnectionState = \"ESTABLISHED\"\n    StateListen      ConnectionState = \"LISTEN\"\n    StateTimeWait    ConnectionState = \"TIME_WAIT\"\n    StateCloseWait   ConnectionState = \"CLOSE_WAIT\"\n    StateNone        ConnectionState = \"-\"\n    // Add others as needed\n)\n\ntype Connection struct {\n    Protocol   Protocol\n    LocalAddr  string\n    RemoteAddr string\n    State      ConnectionState\n}\n```\n\n### 2. Update internal/collector/darwin.go\n```go\nfunc (c *darwinCollector) getProtocol(connType uint32) model.Protocol {\n    switch connType {\n    case 1:\n        return model.ProtocolTCP\n    case 2:\n        return model.ProtocolUDP\n    default:\n        return model.ProtocolUnknown\n    }\n}\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:27:44.402857+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.066907+01:00","closed_at":"2026-01-03T21:59:06.066907+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.6","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:44.405635+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.7","title":"Make UI responsive using width/height","description":"## Problem\nThe `width` and `height` fields in Model are set from `tea.WindowSizeMsg` but never used. UI uses hardcoded widths.\n\n## Locations\n```go\n// internal/ui/model.go:33-34\nwidth  int\nheight int\n```\n\n```go\n// internal/ui/update.go:22-25\ncase tea.WindowSizeMsg:\n    m.width = msg.Width\n    m.height = msg.Height\n    return m, nil\n```\n\n```go\n// internal/ui/view.go:86\npadding := 50 - len(leftPart)  // \u003c-- hardcoded width\n```\n\n## Impact\n- UI doesn't adapt to terminal size\n- Columns misaligned on narrow terminals\n- Wasted space on wide terminals\n\n## Acceptance Criteria\n- [ ] Calculate padding dynamically based on `m.width`\n- [ ] Handle narrow terminals gracefully (truncate or wrap)\n- [ ] Test with various terminal widths\n\n## Implementation\n```go\nfunc (m Model) renderAppHeader(app model.Application, isSelected bool) string {\n    // Use actual width, with fallback\n    availableWidth := m.width\n    if availableWidth == 0 {\n        availableWidth = 80  // fallback\n    }\n    \n    // Reserve space for PIDs on right\n    pidsStr := formatPIDs(app.PIDs)\n    leftMaxWidth := availableWidth - len(pidsStr) - 4  // padding\n    \n    // Build and truncate left part if needed\n    // ...\n}\n```","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:27:44.63334+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.067855+01:00","closed_at":"2026-01-03T21:59:06.067855+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.7","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:44.633794+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.8","title":"Add context cancellation checks in collector","description":"## Problem\nThe `Collect` function doesn't check for context cancellation during the potentially long loop iterating through connections.\n\n## Location\n```go\n// internal/collector/darwin.go:38-74\nfor _, conn := range connections {\n    // No cancellation check here!\n    \n    if conn.Pid == 0 {\n        continue\n    }\n    \n    name := c.getProcessName(ctx, conn.Pid)  // Could be slow\n    // ...\n}\n```\n\n## Impact\n- Application may be slow to quit\n- Timeout doesn't work as expected during long collection cycles\n- Resources wasted processing data that will be discarded\n\n## Acceptance Criteria\n- [ ] Check `ctx.Err()` at start of each loop iteration\n- [ ] Return early with context error if cancelled\n- [ ] Verify quick shutdown with many connections\n\n## Implementation\n```go\nfor _, conn := range connections {\n    // Check for cancellation\n    if err := ctx.Err(); err != nil {\n        return nil, err\n    }\n    \n    if conn.Pid == 0 {\n        continue\n    }\n    // ...\n}\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:27:44.880383+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.068827+01:00","closed_at":"2026-01-03T21:59:06.068827+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.8","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:44.880828+01:00","created_by":"kostya"}]}
{"id":"netmon-al5.9","title":"Add unit tests for model and collector","description":"## Problem\nThe codebase has 0% test coverage. All packages show `[no test files]` when running `go test ./...`.\n\n## Current State\n```\n? github.com/kostyay/netmon/cmd/netmon        [no test files]\n? github.com/kostyay/netmon/internal/collector [no test files]\n? github.com/kostyay/netmon/internal/model    [no test files]\n? github.com/kostyay/netmon/internal/ui       [no test files]\n```\n\n## Acceptance Criteria\n- [ ] Add tests for `internal/model` package\n- [ ] Add tests for `internal/collector` package (may need mocking)\n- [ ] Achieve at least 60% coverage on model package\n- [ ] All tests pass with `go test ./...`\n\n## Test Cases\n\n### internal/model/network_test.go\n```go\nfunc TestNetworkSnapshot_SortByConnectionCount(t *testing.T)\nfunc TestNetworkSnapshot_TotalConnections(t *testing.T)  // if kept\nfunc TestApplication_ConnectionCount(t *testing.T)  // if kept\nfunc TestConnection_fields(t *testing.T)  // basic struct tests\n```\n\n### internal/collector/darwin_test.go\n```go\nfunc TestFormatAddr(t *testing.T)\nfunc TestContainsPID(t *testing.T)\nfunc TestGetProtocol(t *testing.T)\nfunc TestGetState(t *testing.T)\n```\n\n### internal/ui/view_test.go\n```go\nfunc TestFormatPIDs(t *testing.T)\nfunc TestTruncateAddr(t *testing.T)\n```\n\n## Notes\n- Helper functions like `formatAddr`, `containsPID`, `formatPIDs` are easy to test\n- Collector.Collect() may need interface mocking or integration test approach\n- UI Model tests can verify state transitions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:27:45.128019+01:00","created_by":"kostya","updated_at":"2026-01-03T21:59:06.069855+01:00","closed_at":"2026-01-03T21:59:06.069855+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-al5.9","depends_on_id":"netmon-al5","type":"parent-child","created_at":"2026-01-03T21:27:45.128454+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p","title":"Test Coverage: Achieve comprehensive test suite","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-03T21:33:46.3586+01:00","created_by":"kostya","updated_at":"2026-01-03T21:40:17.968362+01:00","closed_at":"2026-01-03T21:40:17.968362+01:00","close_reason":"All test tasks completed - comprehensive test coverage achieved"}
{"id":"netmon-q3p.1","title":"P1: Add model package tests (network_test.go)","description":"Pure unit tests for internal/model/network.go: TestApplicationConnectionCount, TestNetworkSnapshotSortByConnectionCount, TestNetworkSnapshotTotalConnections","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T21:34:02.925755+01:00","created_by":"kostya","updated_at":"2026-01-03T21:36:11.797681+01:00","closed_at":"2026-01-03T21:36:11.797681+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.1","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:02.927885+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.2","title":"P1: Add collector helper function tests (darwin_test.go)","description":"Pure unit tests for helper functions: formatAddr, containsPID, getProtocol - no mocking needed","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T21:34:03.102682+01:00","created_by":"kostya","updated_at":"2026-01-03T21:36:11.79931+01:00","closed_at":"2026-01-03T21:36:11.79931+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.2","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:03.103132+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.3","title":"P1: Add UI utility function tests (view_test.go)","description":"Pure unit tests for utility functions: formatPIDs, truncateAddr","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T21:34:03.283644+01:00","created_by":"kostya","updated_at":"2026-01-03T21:36:11.800533+01:00","closed_at":"2026-01-03T21:36:11.800533+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.3","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:03.28404+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.4","title":"P2: Add UI update tests with mock collector","description":"Tests for Model.Update() handling all message types: KeyMsg, TickMsg, DataMsg, WindowSizeMsg. Requires mock collector.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:34:03.476757+01:00","created_by":"kostya","updated_at":"2026-01-03T21:38:24.157268+01:00","closed_at":"2026-01-03T21:38:24.157268+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.4","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:03.477141+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.4","depends_on_id":"netmon-q3p.1","type":"blocks","created_at":"2026-01-03T21:34:13.540748+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.4","depends_on_id":"netmon-q3p.2","type":"blocks","created_at":"2026-01-03T21:34:13.629492+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.4","depends_on_id":"netmon-q3p.3","type":"blocks","created_at":"2026-01-03T21:34:13.708315+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.5","title":"P2: Add UI model tests with mock collector","description":"Tests for NewModel(), Init(), and model state management with mock collector injection","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:34:03.698406+01:00","created_by":"kostya","updated_at":"2026-01-03T21:38:24.158623+01:00","closed_at":"2026-01-03T21:38:24.158623+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.5","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:03.69878+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.5","depends_on_id":"netmon-q3p.1","type":"blocks","created_at":"2026-01-03T21:34:13.780339+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.5","depends_on_id":"netmon-q3p.2","type":"blocks","created_at":"2026-01-03T21:34:13.845591+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.6","title":"P2: Add collector interface and integration tests","description":"Tests for Collector interface compliance, darwinCollector.Collect() with gopsutil mocks, getProcessName caching tests","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:34:03.929269+01:00","created_by":"kostya","updated_at":"2026-01-03T21:38:24.159677+01:00","closed_at":"2026-01-03T21:38:24.159677+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.6","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:03.929637+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.6","depends_on_id":"netmon-q3p.2","type":"blocks","created_at":"2026-01-03T21:34:13.920387+01:00","created_by":"kostya"}]}
{"id":"netmon-q3p.7","title":"P3: Add main.go integration/smoke test","description":"Integration test for cmd/netmon/main.go - full system verification","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:34:04.155567+01:00","created_by":"kostya","updated_at":"2026-01-03T21:40:10.455188+01:00","closed_at":"2026-01-03T21:40:10.455188+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-q3p.7","depends_on_id":"netmon-q3p","type":"parent-child","created_at":"2026-01-03T21:34:04.155926+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.7","depends_on_id":"netmon-q3p.4","type":"blocks","created_at":"2026-01-03T21:34:13.997189+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.7","depends_on_id":"netmon-q3p.5","type":"blocks","created_at":"2026-01-03T21:34:14.100836+01:00","created_by":"kostya"},{"issue_id":"netmon-q3p.7","depends_on_id":"netmon-q3p.6","type":"blocks","created_at":"2026-01-03T21:34:14.183142+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9","title":"Scaffold Go TUI Network Monitor","description":"Initialize a Go TUI application using Bubble Tea for monitoring network connections on macOS. Includes project structure, linting, Makefile, and basic UI scaffold with table showing applications and ports.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T20:37:05.783912+01:00","created_by":"kostya","updated_at":"2026-01-03T20:46:41.381466+01:00","closed_at":"2026-01-03T20:46:41.381466+01:00","close_reason":"Closed"}
{"id":"netmon-yr9.1","title":"Create project directory structure","description":"Create the flat project structure:\n- cmd/netmon/main.go\n- internal/ui/model.go\n- internal/ui/update.go  \n- internal/ui/view.go\n- internal/ui/styles.go","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:25.602983+01:00","created_by":"kostya","updated_at":"2026-01-03T20:39:46.319409+01:00","closed_at":"2026-01-03T20:39:46.319409+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.1","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:25.605043+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.10","title":"Verify build and run","description":"Run make build, make lint, make run to verify:\n- Project compiles without errors\n- Linter passes\n- TUI displays and responds to q to quit","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:27.569189+01:00","created_by":"kostya","updated_at":"2026-01-03T20:46:30.592615+01:00","closed_at":"2026-01-03T20:46:30.592615+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.10","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:27.569601+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.10","depends_on_id":"netmon-yr9.9","type":"blocks","created_at":"2026-01-03T20:37:42.160229+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.10","depends_on_id":"netmon-yr9.3","type":"blocks","created_at":"2026-01-03T20:37:42.230051+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.10","depends_on_id":"netmon-yr9.4","type":"blocks","created_at":"2026-01-03T20:37:42.302314+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.2","title":"Add Bubble Tea dependencies","description":"Add Go dependencies:\n- github.com/charmbracelet/bubbletea\n- github.com/charmbracelet/lipgloss\n- github.com/charmbracelet/bubbles","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:25.806935+01:00","created_by":"kostya","updated_at":"2026-01-03T20:40:14.187078+01:00","closed_at":"2026-01-03T20:40:14.187078+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.2","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:25.807369+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.3","title":"Configure golangci-lint","description":"Create .golangci.yml with standard linters:\n- gofmt, govet, errcheck, staticcheck\n- gosimple, ineffassign, unused","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:26.020734+01:00","created_by":"kostya","updated_at":"2026-01-03T20:40:14.188811+01:00","closed_at":"2026-01-03T20:40:14.188811+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.3","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:26.02113+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.4","title":"Create Makefile with core targets","description":"Create Makefile with targets:\n- build: go build -o bin/netmon ./cmd/netmon\n- test: go test ./...\n- fmt: gofmt -w .\n- lint: golangci-lint run\n- run: go run ./cmd/netmon","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:26.225718+01:00","created_by":"kostya","updated_at":"2026-01-03T20:40:14.190187+01:00","closed_at":"2026-01-03T20:40:14.190187+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.4","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:26.226084+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.5","title":"Implement TUI Model","description":"Create internal/ui/model.go with:\n- Model struct containing table.Model and quitting bool\n- NewModel() constructor initializing table with columns:\n  Application (20), PID (8), Port (8), Protocol (10)\n- Placeholder row showing 'No data'","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:26.434511+01:00","created_by":"kostya","updated_at":"2026-01-03T20:41:14.016027+01:00","closed_at":"2026-01-03T20:41:14.016027+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.5","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:26.434897+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.5","depends_on_id":"netmon-yr9.1","type":"blocks","created_at":"2026-01-03T20:37:41.165523+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.5","depends_on_id":"netmon-yr9.2","type":"blocks","created_at":"2026-01-03T20:37:41.243227+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.6","title":"Implement TUI Update handler","description":"Create internal/ui/update.go with:\n- Init() returning nil command\n- Update() handling tea.KeyMsg for q/ctrl+c quit\n- Delegate other keys to table component","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:26.64613+01:00","created_by":"kostya","updated_at":"2026-01-03T20:41:14.017473+01:00","closed_at":"2026-01-03T20:41:14.017473+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.6","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:26.646561+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.6","depends_on_id":"netmon-yr9.5","type":"blocks","created_at":"2026-01-03T20:37:41.382566+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.7","title":"Implement TUI View renderer","description":"Create internal/ui/view.go with:\n- View() method rendering header, table, and footer\n- Header: 'netmon - Network Monitor'\n- Footer: 'Press q to quit'","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:26.862459+01:00","created_by":"kostya","updated_at":"2026-01-03T20:41:14.018593+01:00","closed_at":"2026-01-03T20:41:14.018593+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.7","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:26.862828+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.7","depends_on_id":"netmon-yr9.5","type":"blocks","created_at":"2026-01-03T20:37:41.549881+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.7","depends_on_id":"netmon-yr9.8","type":"blocks","created_at":"2026-01-03T20:37:41.625378+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.8","title":"Create Lip Gloss styles","description":"Create internal/ui/styles.go with:\n- HeaderStyle: subtle purple color\n- FooterStyle: muted/dim text\n- TableStyle: basic styling for table component","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:27.094602+01:00","created_by":"kostya","updated_at":"2026-01-03T20:41:14.019614+01:00","closed_at":"2026-01-03T20:41:14.019614+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.8","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:27.094955+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.8","depends_on_id":"netmon-yr9.2","type":"blocks","created_at":"2026-01-03T20:37:41.779619+01:00","created_by":"kostya"}]}
{"id":"netmon-yr9.9","title":"Create main.go entry point","description":"Create cmd/netmon/main.go with:\n- Initialize Model via NewModel()\n- Create and run tea.Program\n- Handle errors and exit codes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T20:37:27.326626+01:00","created_by":"kostya","updated_at":"2026-01-03T20:41:14.020801+01:00","closed_at":"2026-01-03T20:41:14.020801+01:00","close_reason":"Closed","dependencies":[{"issue_id":"netmon-yr9.9","depends_on_id":"netmon-yr9","type":"parent-child","created_at":"2026-01-03T20:37:27.326986+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.9","depends_on_id":"netmon-yr9.6","type":"blocks","created_at":"2026-01-03T20:37:41.929762+01:00","created_by":"kostya"},{"issue_id":"netmon-yr9.9","depends_on_id":"netmon-yr9.7","type":"blocks","created_at":"2026-01-03T20:37:42.009831+01:00","created_by":"kostya"}]}
